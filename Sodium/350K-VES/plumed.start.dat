LOAD FILE=../../PairEntropy.cpp

PAIRENTROPY ...
 LABEL=s2
 ATOMS=1-256
 MAXR=0.7
 SIGMA=0.0125
... PAIRENTROPY

ENERGY LABEL=ene

VOLUME LABEL=vol

COMBINE ...
 ARG=ene,vol
 POWERS=1,1
 COEFFICIENTS=1.,0.0060221409
 PERIODIC=NO
 LABEL=enthalpy
... COMBINE

COMBINE ...
 ARG=enthalpy
 POWERS=1
 COEFFICIENTS=0.004
 PERIODIC=NO
 LABEL=enthalpyPerAtom
... COMBINE

# Construct a bias potential using VES
#
# Basis functions

bf1: BF_LEGENDRE ORDER=40 MINIMUM=-108. MAXIMUM=-92.
bf2: BF_LEGENDRE ORDER=40 MINIMUM=-6.5 MAXIMUM=-1.

# Target dsitribution
td_welltemp: TD_WELLTEMPERED BIASFACTOR=50
# Expansion

VES_LINEAR_EXPANSION ...
 ARG=enthalpyPerAtom,s2
 BASIS_FUNCTIONS=bf1,bf2
 LABEL=b1
 TEMP=350.0
 GRID_BINS=300,300
 TARGET_DISTRIBUTION=td_welltemp
... VES_LINEAR_EXPANSION

# Optimization algorithm

OPT_AVERAGED_SGD ...
  BIAS=b1
  STRIDE=500
  LABEL=o1
  STEPSIZE=5.
  FES_OUTPUT=1000
  BIAS_OUTPUT=1000
  TARGETDIST_STRIDE=500
  #MULTIPLE_WALKERS
... OPT_AVERAGED_SGD

PRINT STRIDE=500  ARG=* FILE=COLVAR
